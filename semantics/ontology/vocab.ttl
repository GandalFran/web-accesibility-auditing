@prefix waa: <https://bisite.usal.es/ontologies/web-accessibility-audit#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix oa: <http://www.w3.org/ns/oa#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix schema: <http://schema.org/> .

# ============================================================
# Ontology Metadata
# ============================================================

<https://bisite.usal.es/ontologies/web-accessibility-audit> a owl:Ontology ;
    dcterms:title "Web Accessibility Audit Vocabulary"@en ;
    dcterms:description "A formal vocabulary for representing web accessibility audit results with semantic grounding, provenance tracking, and dual-modality evidence anchoring."@en ;
    dcterms:created "2026-01-29"^^xsd:date ;
    dcterms:modified "2026-01-29"^^xsd:date ;
    owl:versionInfo "1.0.0" ;
    rdfs:comment "This vocabulary extends PROV-O, Web Annotation, and Dublin Core Terms to represent accessibility audit findings generated by visual-first neuro-symbolic pipelines."@en .

# ============================================================
# Core Classes
# ============================================================

waa:AuditRun a owl:Class ;
    rdfs:label "Audit Run"@en ;
    rdfs:comment "Represents a single execution of the accessibility auditing pipeline over a web page state. Links to findings, provenance, and the audited resource."@en ;
    rdfs:subClassOf prov:Activity .

waa:Finding a owl:Class ;
    rdfs:label "Accessibility Finding"@en ;
    rdfs:comment "A detected accessibility issue or compliance check result. Central entity linking criterion, target, evidence, and recommendation."@en ;
    rdfs:subClassOf prov:Entity .

waa:Criterion a owl:Class ;
    rdfs:label "Accessibility Criterion"@en ;
    rdfs:comment "Represents a WCAG 2.x success criterion (e.g., SC 1.4.3 Contrast Minimum). Links to authoritative definitions."@en ;
    rdfs:subClassOf skos:Concept .

waa:Target a owl:Class ;
    rdfs:label "Target Element"@en ;
    rdfs:comment "Specifies the interface element under evaluation. Supports dual anchoring: DOM selector and visual region coordinates."@en ;
    rdfs:subClassOf oa:SpecificResource .

waa:Evidence a owl:Class ;
    rdfs:label "Evidence"@en ;
    rdfs:comment "Contains raw data grounding a finding: screenshots, bounding boxes, text excerpts, or computed style values."@en ;
    rdfs:subClassOf prov:Entity .

waa:Recommendation a owl:Class ;
    rdfs:label "Remediation Recommendation"@en ;
    rdfs:comment "Structured guidance for fixing an accessibility barrier, including severity, suggested fix, and code examples."@en .

waa:WebResource a owl:Class ;
    rdfs:label "Web Resource"@en ;
    rdfs:comment "The web page or application being audited. Identified by URL and optionally DOM snapshot."@en ;
    rdfs:subClassOf prov:Entity ;
    rdfs:seeAlso schema:WebPage .

waa:ModelInvocation a owl:Class ;
    rdfs:label "Model Invocation"@en ;
    rdfs:comment "Records execution of a Vision-Language Model: prompt, model identifier, inference parameters, and output."@en ;
    rdfs:subClassOf prov:Activity .

waa:PageState a owl:Class ;
    rdfs:label "Page State"@en ;
    rdfs:comment "Captures the rendering context at audit time: DOM snapshot, screenshot, viewport configuration, timestamp."@en ;
    rdfs:subClassOf prov:Entity .

# Evidence Subtypes
waa:ScreenshotEvidence a owl:Class ;
    rdfs:label "Screenshot Evidence"@en ;
    rdfs:comment "Visual capture of the rendered page or region."@en ;
    rdfs:subClassOf waa:Evidence .

waa:BBoxEvidence a owl:Class ;
    rdfs:label "Bounding Box Evidence"@en ;
    rdfs:comment "Spatial coordinates defining a visual region (x, y, width, height)."@en ;
    rdfs:subClassOf waa:Evidence .

waa:DomSnippetEvidence a owl:Class ;
    rdfs:label "DOM Snippet Evidence"@en ;
    rdfs:comment "Extracted HTML or DOM tree fragment."@en ;
    rdfs:subClassOf waa:Evidence .

waa:TextEvidence a owl:Class ;
    rdfs:label "Textual Evidence"@en ;
    rdfs:comment "Natural language description or transcript (e.g., alt-text content, VLM-generated explanation)."@en ;
    rdfs:subClassOf waa:Evidence .

# ============================================================
# Outcome Status Individuals (Enum)
# ============================================================

waa:Pass a owl:NamedIndividual , skos:Concept ;
    rdfs:label "Pass"@en ;
    skos:definition "The target conforms to the criterion." .

waa:Fail a owl:NamedIndividual , skos:Concept ;
    rdfs:label "Fail"@en ;
    skos:definition "The target violates the criterion." .

waa:NeedsReview a owl:NamedIndividual , skos:Concept ;
    rdfs:label "Needs Review"@en ;
    skos:definition "Automated judgment insufficient; manual verification required." .

waa:NotApplicable a owl:NamedIndividual , skos:Concept ;
    rdfs:label "Not Applicable"@en ;
    skos:definition "The criterion does not apply to this target." .

# ============================================================
# Properties for AuditRun
# ============================================================

waa:auditedResource a owl:ObjectProperty ;
    rdfs:label "audited resource"@en ;
    rdfs:comment "Links an AuditRun to the web resource being audited."@en ;
    rdfs:domain waa:AuditRun ;
    rdfs:range waa:WebResource .

waa:hasFinding a owl:ObjectProperty ;
    rdfs:label "has finding"@en ;
    rdfs:comment "Links an AuditRun to one of its accessibility findings."@en ;
    rdfs:domain waa:AuditRun ;
    rdfs:range waa:Finding .

waa:runTimestamp a owl:DatatypeProperty ;
    rdfs:label "run timestamp"@en ;
    rdfs:comment "ISO 8601 timestamp when the audit was executed."@en ;
    rdfs:domain waa:AuditRun ;
    rdfs:range xsd:dateTime .

waa:toolchain a owl:DatatypeProperty ;
    rdfs:label "toolchain"@en ;
    rdfs:comment "Identifier for the auditing pipeline configuration (e.g., 'WCAG-VLM-v1.0')."@en ;
    rdfs:domain waa:AuditRun ;
    rdfs:range xsd:string .

waa:hasProvenanceBundle a owl:ObjectProperty ;
    rdfs:label "has provenance bundle"@en ;
    rdfs:comment "Links to a provenance entity documenting audit execution conditions."@en ;
    rdfs:domain waa:AuditRun ;
    rdfs:range prov:Entity .

waa:pageState a owl:ObjectProperty ;
    rdfs:label "page state"@en ;
    rdfs:comment "Links to the page state captured during audit execution."@en ;
    rdfs:domain waa:AuditRun ;
    rdfs:range waa:PageState .

# ============================================================
# Properties for Finding
# ============================================================

waa:criterion a owl:ObjectProperty ;
    rdfs:label "criterion"@en ;
    rdfs:comment "The WCAG success criterion being evaluated."@en ;
    rdfs:domain waa:Finding ;
    rdfs:range waa:Criterion .

waa:target a owl:ObjectProperty ;
    rdfs:label "target"@en ;
    rdfs:comment "The interface element being evaluated."@en ;
    rdfs:domain waa:Finding ;
    rdfs:range waa:Target .

waa:status a owl:ObjectProperty ;
    rdfs:label "status"@en ;
    rdfs:comment "Outcome of the evaluation: Pass, Fail, NeedsReview, or NotApplicable."@en ;
    rdfs:domain waa:Finding ;
    rdfs:range skos:Concept .

waa:confidence a owl:DatatypeProperty ;
    rdfs:label "confidence"@en ;
    rdfs:comment "Confidence score for probabilistic judgments (0.0 to 1.0)."@en ;
    rdfs:domain waa:Finding ;
    rdfs:range xsd:decimal .

waa:evidence a owl:ObjectProperty ;
    rdfs:label "evidence"@en ;
    rdfs:comment "Links to evidence supporting the finding."@en ;
    rdfs:domain waa:Finding ;
    rdfs:range waa:Evidence .

waa:recommendation a owl:ObjectProperty ;
    rdfs:label "recommendation"@en ;
    rdfs:comment "Suggested remediation for a failed or needs-review finding."@en ;
    rdfs:domain waa:Finding ;
    rdfs:range waa:Recommendation .

waa:severity a owl:DatatypeProperty ;
    rdfs:label "severity"@en ;
    rdfs:comment "Severity level (e.g., 'critical', 'major', 'minor')."@en ;
    rdfs:domain waa:Finding ;
    rdfs:range xsd:string .

# ============================================================
# Properties for Criterion
# ============================================================

# dcterms:identifier is used for WCAG ID (e.g., "WCAG2.2:1.4.3")
# dcterms:source is used for authoritative URL
# skos:prefLabel is used for human-readable name

# ============================================================
# Properties for Target
# ============================================================

waa:domSelector a owl:DatatypeProperty ;
    rdfs:label "DOM selector"@en ;
    rdfs:comment "CSS selector or XPath identifying the target element in the DOM."@en ;
    rdfs:domain waa:Target ;
    rdfs:range xsd:string .

waa:domNodeFingerprint a owl:DatatypeProperty ;
    rdfs:label "DOM node fingerprint"@en ;
    rdfs:comment "Hash or stable identifier for the DOM node (enables cross-version tracking)."@en ;
    rdfs:domain waa:Target ;
    rdfs:range xsd:string .

waa:visualRegion a owl:ObjectProperty ;
    rdfs:label "visual region"@en ;
    rdfs:comment "Links to a spatial region specification (bounding box) for visual evidence anchoring."@en ;
    rdfs:domain waa:Target ;
    rdfs:range waa:BBoxEvidence .

waa:domSnapshot a owl:ObjectProperty ;
    rdfs:label "DOM snapshot"@en ;
    rdfs:comment "Links to a preserved DOM state for reproducibility."@en ;
    rdfs:domain waa:Target ;
    rdfs:range prov:Entity .

# ============================================================
# Properties for Evidence
# ============================================================

waa:evidenceType a owl:ObjectProperty ;
    rdfs:label "evidence type"@en ;
    rdfs:comment "Classification of evidence: screenshot, bbox, DOM snippet, or text."@en ;
    rdfs:domain waa:Evidence .

waa:screenshot a owl:ObjectProperty ;
    rdfs:label "screenshot"@en ;
    rdfs:comment "Links to a screenshot entity (image file with integrity hash)."@en ;
    rdfs:domain waa:Evidence ;
    rdfs:range prov:Entity .

waa:bbox a owl:DatatypeProperty ;
    rdfs:label "bounding box"@en ;
    rdfs:comment "Spatial coordinates as JSON or comma-separated values: x,y,width,height."@en ;
    rdfs:domain waa:BBoxEvidence ;
    rdfs:range xsd:string .

waa:excerpt a owl:DatatypeProperty ;
    rdfs:label "excerpt"@en ;
    rdfs:comment "Textual excerpt or description (e.g., transcribed UI text, alt attribute value)."@en ;
    rdfs:domain waa:Evidence ;
    rdfs:range xsd:string .

# prov:wasDerivedFrom links evidence to source (screenshot, model output, DOM snapshot)

# ============================================================
# Properties for Recommendation
# ============================================================

# dcterms:description for human-readable remediation text

waa:fixExample a owl:DatatypeProperty ;
    rdfs:label "fix example"@en ;
    rdfs:comment "Code snippet or concrete example illustrating the suggested fix."@en ;
    rdfs:domain waa:Recommendation ;
    rdfs:range xsd:string .

# ============================================================
# Properties for ModelInvocation
# ============================================================

waa:modelName a owl:DatatypeProperty ;
    rdfs:label "model name"@en ;
    rdfs:comment "Identifier for the VLM or AI model (e.g., 'llava-v1.5-7b-q4')."@en ;
    rdfs:domain waa:ModelInvocation ;
    rdfs:range xsd:string .

waa:modelVersion a owl:DatatypeProperty ;
    rdfs:label "model version"@en ;
    rdfs:comment "Version string or commit hash for the model."@en ;
    rdfs:domain waa:ModelInvocation ;
    rdfs:range xsd:string .

waa:prompt a owl:DatatypeProperty ;
    rdfs:label "prompt"@en ;
    rdfs:comment "The prompt template or instruction sent to the model."@en ;
    rdfs:domain waa:ModelInvocation ;
    rdfs:range xsd:string .

waa:temperature a owl:DatatypeProperty ;
    rdfs:label "temperature"@en ;
    rdfs:comment "Sampling temperature parameter (controls randomness)."@en ;
    rdfs:domain waa:ModelInvocation ;
    rdfs:range xsd:decimal .

waa:topP a owl:DatatypeProperty ;
    rdfs:label "top-p"@en ;
    rdfs:comment "Nucleus sampling parameter."@en ;
    rdfs:domain waa:ModelInvocation ;
    rdfs:range xsd:decimal .

waa:seed a owl:DatatypeProperty ;
    rdfs:label "random seed"@en ;
    rdfs:comment "Random seed for reproducible generation."@en ;
    rdfs:domain waa:ModelInvocation ;
    rdfs:range xsd:integer .

waa:output a owl:ObjectProperty ;
    rdfs:label "output"@en ;
    rdfs:comment "Links to the raw output entity generated by the model."@en ;
    rdfs:domain waa:ModelInvocation ;
    rdfs:range prov:Entity .

# ============================================================
# Properties for PageState
# ============================================================

waa:screenshotHash a owl:DatatypeProperty ;
    rdfs:label "screenshot hash"@en ;
    rdfs:comment "Cryptographic hash (e.g., SHA-256) for screenshot integrity verification."@en ;
    rdfs:domain waa:PageState ;
    rdfs:range xsd:string .

waa:viewportWidth a owl:DatatypeProperty ;
    rdfs:label "viewport width"@en ;
    rdfs:comment "Width of the rendering viewport in pixels."@en ;
    rdfs:domain waa:PageState ;
    rdfs:range xsd:integer .

waa:viewportHeight a owl:DatatypeProperty ;
    rdfs:label "viewport height"@en ;
    rdfs:comment "Height of the rendering viewport in pixels."@en ;
    rdfs:domain waa:PageState ;
    rdfs:range xsd:integer .

waa:hydrationTimestamp a owl:DatatypeProperty ;
    rdfs:label "hydration timestamp"@en ;
    rdfs:comment "Timestamp when client-side JavaScript hydration completed (for SPAs)."@en ;
    rdfs:domain waa:PageState ;
    rdfs:range xsd:dateTime .
